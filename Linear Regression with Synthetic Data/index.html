<!DOCTYPE html>
<html>
<head>
  <title>Linear Regression with TensorFlow.js</title>
  <!-- Load TensorFlow.js from CDN -->
  <script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs@latest"></script>
</head>
<body>
  <h2>Linear Regression with Synthetic Data</h2>
  <script>
    async function run() {
      // Step 1: Create synthetic training data
      const xs = tf.tensor1d([1, 2, 3, 4]);
      const ys = tf.tensor1d([1, 3, 5, 7]); // y = 2x - 1 (roughly)

      // Step 2: Define a simple sequential model
      const model = tf.sequential();
      model.add(tf.layers.dense({units: 1, inputShape: [1]}));

      // Step 3: Compile the model
      model.compile({
        optimizer: tf.train.sgd(0.1), // stochastic gradient descent
        loss: 'meanSquaredError'
      });

      // Step 4: Train the model
      console.log("Training started...");
      await model.fit(xs, ys, {
        epochs: 200,
        callbacks: {
          onEpochEnd: (epoch, logs) => {
            if (epoch % 50 === 0) {
              console.log(`Epoch ${epoch}: loss = ${logs.loss}`);
            }
          }
        }
      });

      // Step 5: Make predictions
      const output = model.predict(tf.tensor2d([5, 6, 7], [3, 1]));
      output.print(); // Should be close to [9, 11, 13]
    }

    run();
  </script>
</body>
</html>
